{"remainingRequest":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/src/utils/common.js","dependencies":[{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/src/utils/common.js","mtime":1673149569000},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/babel.config.js","mtime":1673149569000},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/cache-loader/dist/cjs.js","mtime":1665459455731},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/babel-loader/lib/index.js","mtime":1677319763836}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5lcnJvci50by1zdHJpbmcuanMiOwovLyDlm77niYfml4vovazlpITnkIYgLT4gYmFzZTY0CmV4cG9ydCB2YXIgcm90YXRlQmFzZTY0SW1nID0gZnVuY3Rpb24gcm90YXRlQmFzZTY0SW1nKHNyYywgZWRnLCBjYWxsYmFjaykgewogIHRyeSB7CiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CiAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICB2YXIgaW1nVyA9IDA7IC8vIOWbvueJh+WuveW6pgoKICAgIHZhciBpbWdIID0gMDsgLy8g5Zu+54mH6auY5bqmCgogICAgdmFyIHNpemUgPSAwOyAvLyBjYW52YXPliJ3lp4vlpKflsI8KCiAgICBpZiAoZWRnICUgOTAgIT09IDApIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCfml4vovazop5Lluqblv4XpobvmmK85MOeahOWAjeaVsCEnKTsKICAgIH0KCiAgICBlZGcgPCAwICYmIChlZGcgPSBlZGcgJSAzNjAgKyAzNjApOwogICAgdmFyIHF1YWRyYW50ID0gZWRnIC8gOTAgJSA0OyAvLyDml4vovazosaHpmZAKCiAgICB2YXIgY3V0Q29vciA9IHsKICAgICAgc3g6IDAsCiAgICAgIHN5OiAwLAogICAgICBleDogMCwKICAgICAgZXk6IDAKICAgIH07IC8vIOijgeWJquWdkOaghwoKICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZSgpOwogICAgaW1hZ2Uuc3JjID0gc3JjOwogICAgaW1hZ2UuY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJzsKCiAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGltZ1cgPSBpbWFnZS53aWR0aDsKICAgICAgaW1nSCA9IGltYWdlLmhlaWdodDsKICAgICAgc2l6ZSA9IGltZ1cgPiBpbWdIID8gaW1nVyA6IGltZ0g7CiAgICAgIGNhbnZhcy53aWR0aCA9IHNpemUgKiAyOwogICAgICBjYW52YXMuaGVpZ2h0ID0gc2l6ZSAqIDI7CgogICAgICBzd2l0Y2ggKHF1YWRyYW50KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgY3V0Q29vci5zeCA9IHNpemU7CiAgICAgICAgICBjdXRDb29yLnN5ID0gc2l6ZTsKICAgICAgICAgIGN1dENvb3IuZXggPSBzaXplICsgaW1nVzsKICAgICAgICAgIGN1dENvb3IuZXkgPSBzaXplICsgaW1nSDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBjdXRDb29yLnN4ID0gc2l6ZSAtIGltZ0g7CiAgICAgICAgICBjdXRDb29yLnN5ID0gc2l6ZTsKICAgICAgICAgIGN1dENvb3IuZXggPSBzaXplOwogICAgICAgICAgY3V0Q29vci5leSA9IHNpemUgKyBpbWdXOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGN1dENvb3Iuc3ggPSBzaXplIC0gaW1nVzsKICAgICAgICAgIGN1dENvb3Iuc3kgPSBzaXplIC0gaW1nSDsKICAgICAgICAgIGN1dENvb3IuZXggPSBzaXplOwogICAgICAgICAgY3V0Q29vci5leSA9IHNpemU7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgY3V0Q29vci5zeCA9IHNpemU7CiAgICAgICAgICBjdXRDb29yLnN5ID0gc2l6ZSAtIGltZ1c7CiAgICAgICAgICBjdXRDb29yLmV4ID0gc2l6ZSArIGltZ0g7CiAgICAgICAgICBjdXRDb29yLmV5ID0gc2l6ZSArIGltZ1c7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgY3R4LnRyYW5zbGF0ZShzaXplLCBzaXplKTsKICAgICAgY3R4LnJvdGF0ZShlZGcgKiBNYXRoLlBJIC8gMTgwKTsKICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIHZhciBpbWdEYXRhID0gY3R4LmdldEltYWdlRGF0YShjdXRDb29yLnN4LCBjdXRDb29yLnN5LCBjdXRDb29yLmV4LCBjdXRDb29yLmV5KTsKCiAgICAgIGlmIChxdWFkcmFudCAlIDIgPT09IDApIHsKICAgICAgICBjYW52YXMud2lkdGggPSBpbWdXOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSBpbWdIOwogICAgICB9IGVsc2UgewogICAgICAgIGNhbnZhcy53aWR0aCA9IGltZ0g7CiAgICAgICAgY2FudmFzLmhlaWdodCA9IGltZ1c7CiAgICAgIH0KCiAgICAgIGN0eC5wdXRJbWFnZURhdGEoaW1nRGF0YSwgMCwgMCk7CgogICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgY2FsbGJhY2soY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJywgMC43KSk7CiAgICAgIH0KICAgIH07CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5sb2coZSk7CiAgfQp9Ow=="},{"version":3,"sources":["/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/src/utils/common.js"],"names":["rotateBase64Img","src","edg","callback","canvas","document","createElement","ctx","getContext","imgW","imgH","size","Error","quadrant","cutCoor","sx","sy","ex","ey","image","Image","crossOrigin","onload","width","height","translate","rotate","Math","PI","drawImage","imgData","getImageData","putImageData","toDataURL","e","console","log"],"mappings":"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","sourcesContent":["// 图片旋转处理 -> base64\nexport const rotateBase64Img = (src, edg, callback) => {\n  try {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n\n    let imgW = 0 // 图片宽度\n    let imgH = 0 // 图片高度\n    let size = 0 // canvas初始大小\n\n    if (edg % 90 !== 0) {\n      throw new Error('旋转角度必须是90的倍数!')\n    }\n\n    (edg < 0) && (edg = (edg % 360) + 360)\n    const quadrant = (edg / 90) % 4 // 旋转象限\n    const cutCoor = { sx: 0, sy: 0, ex: 0, ey: 0 } // 裁剪坐标\n\n    const image = new Image()\n    image.src = src\n    image.crossOrigin = 'anonymous'\n\n    image.onload = function () {\n      imgW = image.width\n      imgH = image.height\n      size = imgW > imgH ? imgW : imgH\n\n      canvas.width = size * 2\n      canvas.height = size * 2\n      switch (quadrant) {\n        case 0:\n          cutCoor.sx = size\n          cutCoor.sy = size\n          cutCoor.ex = size + imgW\n          cutCoor.ey = size + imgH\n          break\n        case 1:\n          cutCoor.sx = size - imgH\n          cutCoor.sy = size\n          cutCoor.ex = size\n          cutCoor.ey = size + imgW\n          break\n        case 2:\n          cutCoor.sx = size - imgW\n          cutCoor.sy = size - imgH\n          cutCoor.ex = size\n          cutCoor.ey = size\n          break\n        case 3:\n          cutCoor.sx = size\n          cutCoor.sy = size - imgW\n          cutCoor.ex = size + imgH\n          cutCoor.ey = size + imgW\n          break\n      }\n\n      ctx.translate(size, size)\n      ctx.rotate(edg * Math.PI / 180)\n      ctx.drawImage(image, 0, 0)\n\n      const imgData = ctx.getImageData(cutCoor.sx, cutCoor.sy, cutCoor.ex, cutCoor.ey)\n      if (quadrant % 2 === 0) {\n        canvas.width = imgW\n        canvas.height = imgH\n      } else {\n        canvas.width = imgH\n        canvas.height = imgW\n      }\n      ctx.putImageData(imgData, 0, 0)\n\n      if (typeof callback === 'function') {\n        callback(canvas.toDataURL('image/png', 0.7))\n      }\n    }\n  } catch (e) {\n    console.log(e)\n  }\n}"]}]}