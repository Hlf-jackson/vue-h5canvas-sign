{"remainingRequest":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/src/views/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/src/views/Home.vue","mtime":1677315824289},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/babel.config.js","mtime":1673149569000},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/cache-loader/dist/cjs.js","mtime":1665459455731},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/babel-loader/lib/index.js","mtime":1677319763836},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/cache-loader/dist/cjs.js","mtime":1665459455731},{"path":"/Users/mac/Desktop/未命名文件夹/vue-h5canvas-sign/node_modules/vue-loader/lib/index.js","mtime":1677319766737}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFNpZ25hdHVyZVBhZCBmcm9tICJzaWduYXR1cmVfcGFkIjsKaW1wb3J0IHsgcm90YXRlQmFzZTY0SW1nIH0gZnJvbSAiQC91dGlscy9jb21tb24iOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlNpZ25OYW1lQ2FudmFzIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2FudmFzTm9kZTogbnVsbCwKICAgICAgcHJldmlld0ltYWdlOiBudWxsCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdGFsSGFuZGxlKCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5pbml0YWxIYW5kbGUsIGZhbHNlKTsKICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5pbml0YWxIYW5kbGUsIGZhbHNlKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXRhbEhhbmRsZTogZnVuY3Rpb24gaW5pdGFsSGFuZGxlKCkgewogICAgICB2YXIgX2NhbnZhc0JveCA9IHRoaXMuJHJlZnMuY2FudmFzUmVmOwogICAgICB2YXIgX2NhbnZhcyA9IHRoaXMuJHJlZnMuY2FudmFzTWFwUmVmOwoKICAgICAgaWYgKCFfY2FudmFzQm94IHx8ICFfY2FudmFzKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBfY2FudmFzLndpZHRoID0gX2NhbnZhc0JveC5jbGllbnRXaWR0aDsKICAgICAgX2NhbnZhcy5oZWlnaHQgPSBfY2FudmFzQm94LmNsaWVudEhlaWdodDsKICAgICAgdGhpcy5nb0NsZWFyKCk7CiAgICAgIHRoaXMuY2FudmFzTm9kZSA9IG5ldyBTaWduYXR1cmVQYWQoX2NhbnZhcywgewogICAgICAgIG1pbldpZHRoOiAyLAogICAgICAgIG1heFdpZHRoOiAyLAogICAgICAgIHBlbkNvbG9yOiAicmdiKDAsIDAsIDApIgogICAgICB9KTsKICAgIH0sCiAgICBnb0NsZWFyOiBmdW5jdGlvbiBnb0NsZWFyKCkgewogICAgICBpZiAodGhpcy5jYW52YXNOb2RlKSB7CiAgICAgICAgdGhpcy5jYW52YXNOb2RlLmNsZWFyKCk7CiAgICAgICAgdGhpcy5wcmV2aWV3SW1hZ2UgPSBudWxsOwogICAgICB9CiAgICB9LAogICAgZ29TdXJlOiBmdW5jdGlvbiBnb1N1cmUoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgY2FudmFzTm9kZSA9IHRoaXMuY2FudmFzTm9kZTsgLy8g6YeN5paw5Yid5aeL5YyW55S75biDCgogICAgICBpZiAoIWNhbnZhc05vZGUpIHsKICAgICAgICB0aGlzLmluaXRhbEhhbmRsZSgpOwogICAgICB9IC8vIOaYr+WQpuetvuWtlwoKCiAgICAgIGlmIChjYW52YXNOb2RlLmlzRW1wdHkoKSkgewogICAgICAgIHRoaXMuJHRvYXN0KCLmgqjov5jmsqHmnInnrb7lkI0iKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8g5Zu+5YOP5peL6L2s5LqM5qyh5aSE55CGCgoKICAgICAgdmFyIF9ib3hXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwogICAgICB2YXIgX2JveEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDsKCiAgICAgIHZhciBfc2lnbkltZyA9IGNhbnZhc05vZGUudG9EYXRhVVJMKCJpbWFnZS9wbmciLCAwLjYpOwoKICAgICAgaWYgKF9ib3hXaWR0aCA8IF9ib3hIZWlnaHQpIHsKICAgICAgICB0aGlzLnByZXZpZXdJbWFnZSA9IF9zaWduSW1nOwogICAgICB9IGVsc2UgewogICAgICAgIHJvdGF0ZUJhc2U2NEltZyhfc2lnbkltZywgLTkwLCBmdW5jdGlvbiAoaW1nVXJsUmVzKSB7CiAgICAgICAgICBfdGhpcy5wcmV2aWV3SW1hZ2UgPSBpbWdVcmxSZXM7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAqBA,OAAA,YAAA,MAAA,eAAA;AACA,SAAA,eAAA,QAAA,gBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,gBADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,UAAA,EAAA,IADA;AAEA,MAAA,YAAA,EAAA;AAFA,KAAA;AAIA,GAPA;AAQA,EAAA,OARA,qBAQA;AACA,SAAA,YAAA;AACA,IAAA,MAAA,CAAA,gBAAA,CAAA,QAAA,EAAA,KAAA,YAAA,EAAA,KAAA;AACA,GAXA;AAYA,EAAA,aAZA,2BAYA;AACA,IAAA,MAAA,CAAA,mBAAA,CAAA,QAAA,EAAA,KAAA,YAAA,EAAA,KAAA;AACA,GAdA;AAeA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,0BACA;AACA,UAAA,UAAA,GAAA,KAAA,KAAA,CAAA,SAAA;AACA,UAAA,OAAA,GAAA,KAAA,KAAA,CAAA,YAAA;;AACA,UAAA,CAAA,UAAA,IAAA,CAAA,OAAA,EAAA;AACA,eAAA,KAAA;AACA;;AAEA,MAAA,OAAA,CAAA,KAAA,GAAA,UAAA,CAAA,WAAA;AACA,MAAA,OAAA,CAAA,MAAA,GAAA,UAAA,CAAA,YAAA;AAEA,WAAA,OAAA;AACA,WAAA,UAAA,GAAA,IAAA,YAAA,CAAA,OAAA,EAAA;AACA,QAAA,QAAA,EAAA,CADA;AAEA,QAAA,QAAA,EAAA,CAFA;AAGA,QAAA,QAAA,EAAA;AAHA,OAAA,CAAA;AAKA,KAjBA;AAmBA,IAAA,OAnBA,qBAmBA;AACA,UAAA,KAAA,UAAA,EAAA;AACA,aAAA,UAAA,CAAA,KAAA;AACA,aAAA,YAAA,GAAA,IAAA;AACA;AACA,KAxBA;AA0BA,IAAA,MA1BA,oBA0BA;AAAA;;AACA,UAAA,UAAA,GAAA,KAAA,UAAA,CADA,CAEA;;AACA,UAAA,CAAA,UAAA,EAAA;AACA,aAAA,YAAA;AACA,OALA,CAOA;;;AACA,UAAA,UAAA,CAAA,OAAA,EAAA,EAAA;AACA,aAAA,MAAA,CAAA,QAAA;AACA,eAAA,KAAA;AACA,OAXA,CAaA;;;AACA,UAAA,SAAA,GAAA,MAAA,CAAA,UAAA;AACA,UAAA,UAAA,GAAA,MAAA,CAAA,WAAA;;AACA,UAAA,QAAA,GAAA,UAAA,CAAA,SAAA,CAAA,WAAA,EAAA,GAAA,CAAA;;AACA,UAAA,SAAA,GAAA,UAAA,EAAA;AACA,aAAA,YAAA,GAAA,QAAA;AACA,OAFA,MAEA;AACA,QAAA,eAAA,CAAA,QAAA,EAAA,CAAA,EAAA,EAAA,UAAA,SAAA,EAAA;AACA,UAAA,KAAA,CAAA,YAAA,GAAA,SAAA;AACA,SAFA,CAAA;AAGA;AACA;AAlDA;AAfA,CAAA","sourcesContent":["<template>\n  <div class=\"canvas-wrap\">\n    <div v-show=\"!previewImage\" ref=\"canvasRef\" class=\"canvas-wrap-box\">\n      <canvas\n        id=\"canvas-map\"\n        ref=\"canvasMapRef\"\n        width=\"100\"\n        height=\"100\"\n      ></canvas>\n    </div>\n    <div class=\"preview-wrap\" v-show=\"previewImage\">\n      <img class=\"preview-image\" :src=\"previewImage\" alt=\"生成预览\" />\n    </div>\n    <div class=\"btn-box\">\n      <span class=\"clear-btn\" @click=\"goClear\">清除</span>\n      <span class=\"sure-btn\" @click=\"goSure\">确认</span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SignaturePad from \"signature_pad\";\nimport { rotateBase64Img } from \"@/utils/common\";\n\nexport default {\n  name: \"SignNameCanvas\",\n  data() {\n    return {\n      canvasNode: null,\n      previewImage: null,\n    };\n  },\n  mounted() {\n    this.initalHandle();\n    window.addEventListener(\"resize\", this.initalHandle, false);\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"resize\", this.initalHandle, false);\n  },\n  methods: {\n    initalHandle() {\n      const _canvasBox = this.$refs.canvasRef;\n      const _canvas = this.$refs.canvasMapRef;\n      if (!_canvasBox || !_canvas) {\n        return false;\n      }\n\n      _canvas.width = _canvasBox.clientWidth;\n      _canvas.height = _canvasBox.clientHeight;\n\n      this.goClear();\n      this.canvasNode = new SignaturePad(_canvas, {\n        minWidth: 2,\n        maxWidth: 2,\n        penColor: \"rgb(0, 0, 0)\",\n      });\n    },\n\n    goClear() {\n      if (this.canvasNode) {\n        this.canvasNode.clear();\n        this.previewImage = null;\n      }\n    },\n\n    goSure() {\n      const canvasNode = this.canvasNode;\n      // 重新初始化画布\n      if (!canvasNode) {\n        this.initalHandle();\n      }\n\n      // 是否签字\n      if (canvasNode.isEmpty()) {\n        this.$toast(\"您还没有签名\");\n        return false;\n      }\n\n      // 图像旋转二次处理\n      const _boxWidth = window.innerWidth;\n      const _boxHeight = window.innerHeight;\n      const _signImg = canvasNode.toDataURL(\"image/png\", 0.6);\n      if (_boxWidth < _boxHeight) {\n        this.previewImage = _signImg;\n      } else {\n        rotateBase64Img(_signImg, -90, (imgUrlRes) => {\n          this.previewImage = imgUrlRes;\n        });\n      }\n    },\n  },\n};\n</script>\n\n<style lang='css' scoped>\n\n.canvas-wrap .btn-box .clear-btn,\n.canvas-wrap .btn-box .sure-btn {\n  display: inline-block;\n  width: 100px;\n  height: 24px;\n  margin: 0 10px;\n  line-height: 24px;\n  border-radius: 6px;\n  background-color: #fff;\n}\n\n.canvas-wrap .btn-box .clear-btn {\n  color: #898989;\n\tbackground: #d4d4d4;\n}\n\n.canvas-wrap .btn-box .sure-btn {\n  color: #fff;\n  background: linear-gradient(100deg, #ff4e01 0%, #ffbc01 100%);\n}\n\n.canvas-wrap .canvas-wrap-box {\n  /* left: 22%; */\n  box-sizing: border-box;\n  width: 20vw;\n  height: 80vh;\n  border: 1px dashed #d4d4d4;\n  overflow: hidden;\n  background-color: #fff;\n}\n\n/* 竖屏 css */\n@media screen and (orientation: portrait) {\n  .canvas-wrap .canvas-wrap-box {\n    width: 90%;\n    height: 30vh;\n    margin: 20px auto 0;\n  }\n  .preview-wrap {\n    margin: 20px auto 0;\n  }\n  .canvas-wrap .btn-box {\n    margin-top: 16px;\n  }\n}\n\n/* 横屏 css */\n\n@media screen and (orientation: landscape) {\n  /* 横屏样式自己调试 */\n}\n</style>\n"],"sourceRoot":"src/views"}]}